generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                      String     @id @default(uuid())
  name                    String
  email                   String     @unique
  profilePhoto            String?
  profilePhotoUrlPublicId String?
  password                String
  needPasswordChange      Boolean    @default(true)
  otp                     Int?
  needRoleChange          Boolean    @default(false)
  phone                   String?
  address                 String?
  role                    UserRole   @default(USER)
  isDeleted               Boolean    @default(false)
  status                  UserStatus @default(ACTIVE)
  createdAt               DateTime   @default(now())
  updatedAt               DateTime   @updatedAt
  posts                   Post[]
  reviews                 Review[]

  @@map("users")
}

model Post {
  id               String     @id @default(uuid())
  authorId         String
  author           User       @relation(fields: [authorId], references: [id])
  title            String
  photoUrl         String?
  photoUrlPublicId String?
  videoUrl         String?
  description      Json?
  division         String
  district         String
  postOffice       String
  postCode         String
  status           PostStatus @default(ONREVIEW)
  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt
  reviews          Review[]

  @@map("posts")
}

model Review {
  id        String     @id @default(uuid())
  postId    String
  post      Post       @relation(fields: [postId], references: [id])
  userId    String
  user      User       @relation(fields: [userId], references: [id])
  review    String
  status    PostStatus @default(ONREVIEW)
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  @@map("reviews")
}

enum UserRole {
  SUPER_ADMIN
  ADMIN
  MODERATOR
  USER
}

enum UserStatus {
  ACTIVE
  BLOCKED
  DELETED
}

enum PostStatus {
  ACTIVE
  INACTIVE
  ONREVIEW
  REJECTED
}
